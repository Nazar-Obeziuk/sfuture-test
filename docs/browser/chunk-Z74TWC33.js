import{a as L}from"./chunk-7JM5YIYR.js";import{a as z}from"./chunk-KQNCCB3Z.js";import{$a as k,E as m,F as U,K as T,O as N,P as Z,Q as Y,R as h,S as u,T as P,W as E,Z as M,_ as I,_a as O,a as R,ba as V,bb as H,c as D,cb as v,da as J,ea as B,eb as b,fb as S,hb as d,ib as w,k as y,mb as l,n as x,o as A}from"./chunk-RCXM74FE.js";var C,Q=new Uint8Array(16);function W(){if(!C&&(C=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!C))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return C(Q)}var o=[];for(let r=0;r<256;++r)o.push((r+256).toString(16).slice(1));function q(r,n=0){return o[r[n+0]]+o[r[n+1]]+o[r[n+2]]+o[r[n+3]]+"-"+o[r[n+4]]+o[r[n+5]]+"-"+o[r[n+6]]+o[r[n+7]]+"-"+o[r[n+8]]+o[r[n+9]]+"-"+o[r[n+10]]+o[r[n+11]]+o[r[n+12]]+o[r[n+13]]+o[r[n+14]]+o[r[n+15]]}var X=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$={randomUUID:X};function ee(r,n,g){if($.randomUUID&&!n&&!r)return $.randomUUID();r=r||{};let e=r.random||(r.rng||W)();if(e[6]=e[6]&15|64,e[8]=e[8]&63|128,n){g=g||0;for(let t=0;t<16;++t)n[g+t]=e[t];return n}return q(e)}var F=ee;var K=(()=>{let n=class n{constructor(e){this.afs=e,this.scheduleCollection=O(this.afs,"users")}getOneUser(e){let t=d(this.afs,`users/${e}`);return v(t,{idField:"id"})}setUserScheduleDay(e,t){let i=d(this.afs,"users",e);return l(i,{sheduleWeeks:S(t)})}updateUser(e,t){let i=d(this.afs,`users/${t}`);return l(i,R({},e))}updateUserScheduleDay(e,t,i){return D(this,null,function*(){let s=d(this.afs,"users",e),a=(yield w(s)).data(),c=a.sheduleWeeks.findIndex(_=>_.id===t);return c!==-1?(a.sheduleWeeks[c]=i,l(s,{sheduleWeeks:a.sheduleWeeks})):(console.error(`Exercise with ID ${t} not found in userExercises`),Promise.reject(`Exercise with ID ${t} not found in userExercises`))})}isSameDay(e,t){return e===t}deleteUserExercise(e,t){let i=d(this.afs,"users",e);return l(i,{sheduleWeeks:b(t)})}};n.\u0275fac=function(t){return new(t||n)(x(k))},n.\u0275prov=y({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})();function re(r,n){if(r&1&&(h(0,"div",12)(1,"div",13),P(2,"div",14),u(),h(3,"h5",15),M(4),J(5,"slice"),u()()),r&2){let g=n.$implicit;m(2),T("height",g.percentCount,"%"),m(2),I(B(5,3,g.nameOfDay,0,3))}}var ye=(()=>{let n=class n{constructor(e,t){this.userExerciseService=e,this.schedulerService=t,this.lengthOfAllUserExercises=[],this.percentCount=0,this.today=new Date,this.daysOfWeek=[]}ngOnInit(){this.getPersonalData(),this.updateWeekRange(),this.setTodaysDay(),this.getPercentOfAcitivity(),this.getWeekData()}getPersonalData(){let e=localStorage.getItem("currentUser");this.currentUserId=e?JSON.parse(e):void 0}getStartAndEndOfWeek(){let e=(this.startDate.getMonth()+1).toString(),t=this.startDate.getDate().toString(),i=(this.endDate.getMonth()+1).toString(),s=this.endDate.getDate().toString();t.length===1&&(t="0"+t),s.length===1&&(s="0"+s),e.length===1&&(e="0"+e),i.length===1&&(i="0"+i),this.weekInterval=`${t}.${e}.${this.startDate.getFullYear()} - ${s}.${i}.${this.endDate.getFullYear()}`}updateWeekRange(){let e=new Date(this.today);e.setDate(this.today.getDate()-this.today.getDay());let t=new Date(this.today);t.setDate(this.today.getDate()+(6-this.today.getDay())),this.startDate=e,this.endDate=t,this.getStartAndEndOfWeek(),this.generateDaysOfWeek()}setTodaysDay(){let e=`${this.padZero(this.today.getDate())}.${this.padZero(this.today.getMonth()+1)}.${this.today.getFullYear()}`;this.getPersonalData(),localStorage.getItem("currentUser")&&this.userExerciseService.getOneUser(this.currentUserId.uid).subscribe(t=>{let i=t;this.daysOfWeek.forEach(s=>{let p=i.sheduleWeeks.some(a=>this.isSameDate(s.date,a.date));s.date===e&&(p||this.schedulerService.setUserScheduleDay(this.currentUserId.uid,s).then(()=>{}).catch(a=>console.log(a)))})})}isSameDate(e,t){return e===t}generateDaysOfWeek(){this.daysOfWeek=[];for(let e=0;e<7;e++){let t=new Date(this.startDate);t.setDate(t.getDate()+e);let i=t.getDate(),s=t.getMonth()+1,p=t.getFullYear(),a=`${this.padZero(i)}.${this.padZero(s)}.${p}`,c={id:F(),date:a,nameOfDay:this.getDayName(t.getDay()),percentCount:0};this.daysOfWeek.push(c)}}padZero(e){return e<10?`0${e}`:`${e}`}getDayName(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]}previousWeek(){this.startDate.setDate(this.startDate.getDate()-7),this.endDate.setDate(this.endDate.getDate()-7),this.getStartAndEndOfWeek(),this.generateDaysOfWeek(),this.getPercentOfAcitivity()}nextWeek(){this.startDate.setDate(this.startDate.getDate()+7),this.endDate.setDate(this.endDate.getDate()+7),this.getStartAndEndOfWeek(),this.generateDaysOfWeek(),this.getPercentOfAcitivity()}getPercentOfAcitivity(){let e=`${this.padZero(this.today.getDate())}.${this.padZero(this.today.getMonth()+1)}.${this.today.getFullYear()}`;this.getPersonalData(),localStorage.getItem("currentUser")&&this.userExerciseService.getOneUser(this.currentUserId.uid).subscribe(s=>{let p=s;this.lengthOfAllUserExercises=p.userExercises;let a=this.lengthOfAllUserExercises.filter(c=>c.completed===!0);this.percentCount=a.length/this.lengthOfAllUserExercises.length*100,this.schedulerService.getOneUser(this.currentUserId.uid).subscribe(c=>{c.sheduleWeeks.forEach(f=>{e===f.date&&(f.percentCount=this.percentCount,localStorage.setItem("currentSheduleDay",JSON.stringify(f))),this.daysOfWeek.forEach(j=>{j.date===f.date&&(j.percentCount=f.percentCount)})})})});let t=localStorage.getItem("currentSheduleDay"),i=t?JSON.parse(t):void 0;i.percentCount>0&&this.schedulerService.updateUserScheduleDay(this.currentUserId.uid,i.id,i).then(()=>{}).catch(s=>console.log(s))}getWeekData(){this.getPersonalData(),localStorage.getItem("currentUser")&&this.schedulerService.getOneUser(this.currentUserId.uid).subscribe(e=>{let t=e;this.daysOfWeek.forEach(i=>{t.sheduleWeeks.forEach(s=>{i.date===s.date&&(i.percentCount=s.percentCount)})})})}};n.\u0275fac=function(t){return new(t||n)(U(L),U(K))},n.\u0275cmp=A({type:n,selectors:[["app-schedule"]],standalone:!0,features:[V],decls:19,vars:1,consts:[[1,"container"],[1,"block"],[1,"block__wrapper"],[1,"block__top_header"],["src","assets/images/previous-icon.svg","alt","",1,"top__header_prev",3,"click"],[1,"top__header_title"],["src","assets/images/next-icon.svg","alt","",1,"top__header_next",3,"click"],[1,"block__wrapper_bottom"],[1,"block__bottom_main"],[1,"bottom__main_line"],[1,"block__wrapper_top"],[1,"block__top_schedule"],[1,"block__top_col"],[1,"top__col_wrapper"],[1,"col__wrapper_item"],[1,"top__col_text"],["class","block__top_col"]],template:function(t,i){t&1&&(h(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"img",4),E("click",function(){return i.previousWeek()}),u(),h(5,"p",5),M(6),u(),h(7,"img",6),E("click",function(){return i.nextWeek()}),u()(),h(8,"div",7)(9,"div",8),P(10,"div",9)(11,"div",9)(12,"div",9)(13,"div",9)(14,"div",9),u(),h(15,"div",10)(16,"div",11),Z(17,re,6,7,"div",16,N),u()()()()()()),t&2&&(m(6),I(i.weekInterval),m(11),Y(i.daysOfWeek))},dependencies:[z],styles:['@charset "UTF-8";.container[_ngcontent-%COMP%]{width:590px;height:340px}.block[_ngcontent-%COMP%]{width:100%;height:100%;border:1px solid #f5f5f5;border-radius:10px}.block__wrapper[_ngcontent-%COMP%]{height:100%}.block__wrapper_bottom[_ngcontent-%COMP%]{height:248px;position:relative}.block__wrapper_top[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.block__bottom_main[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-between;flex-direction:column}.block__top_header[_ngcontent-%COMP%]{padding:30px;width:100%;display:flex;align-items:center;justify-content:space-between}.block__top_schedule[_ngcontent-%COMP%]{padding:0 30px;width:586px;display:flex;align-items:center;justify-content:space-between}.block__top_col[_ngcontent-%COMP%]{width:50px;height:230px;display:flex;align-items:center;justify-content:space-between;flex-direction:column}.bottom__main_line[_ngcontent-%COMP%]{width:100%;height:50px;border-top:1px dashed #f5f5f5}.top__header_title[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.top__header_prev[_ngcontent-%COMP%], .top__header_next[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;cursor:pointer}.top__col_wrapper[_ngcontent-%COMP%]{height:200px;width:100%;display:flex;align-items:flex-end}.col__wrapper_item[_ngcontent-%COMP%]{width:100%;background:#9ECEFF;border-radius:10px}.today[_ngcontent-%COMP%]{color:red}@media (max-width: 440px){.container[_ngcontent-%COMP%]{width:100%}.block[_ngcontent-%COMP%]{width:100%;height:320px}.block__wrapper[_ngcontent-%COMP%]{width:100%;height:100%}.block__wrapper_bottom[_ngcontent-%COMP%]{height:248px}.block__wrapper_top[_ngcontent-%COMP%]{width:100%}.block__top_header[_ngcontent-%COMP%]{padding:20px;width:100%}.block__top_schedule[_ngcontent-%COMP%]{padding:0 10px;width:100%}.block__top_col[_ngcontent-%COMP%]{width:10%;height:230px}.block__bottom_main[_ngcontent-%COMP%]{width:100%}.top__header_title[_ngcontent-%COMP%]{font-size:14px}.top__header_next[_ngcontent-%COMP%], .top__header_prev[_ngcontent-%COMP%]{width:10px;height:14px}.block__bottom_main[_ngcontent-%COMP%]   .bottom__main_line[_ngcontent-%COMP%]:last-child{height:40px}}']});let r=n;return r})();var ve=(()=>{let n=class n{constructor(e){this.afs=e,this.userCollection=O(this.afs,"users")}getAllUsers(){return H(this.userCollection,{idField:"id"})}getOneUser(e){let t=d(this.afs,`users/${e}`);return v(t,{idField:"id"})}setUserCoach(e,t){let i=d(this.afs,"users",e);return l(i,{coaches:S(t)})}updateUserCoach(e,t,i){return D(this,null,function*(){let s=d(this.afs,"users",e),a=(yield w(s)).data(),c=a.userExercises.findIndex(_=>_.id===t);return c!==-1?(a.coaches[c]=i,l(s,{coaches:a.coaches})):(console.error(`Exercise with ID ${t} not found in userExercises`),Promise.reject(`Exercise with ID ${t} not found in userExercises`))})}deleteUserCoach(e,t){let i=d(this.afs,"users",e);return l(i,{coaches:b(t)})}};n.\u0275fac=function(t){return new(t||n)(x(k))},n.\u0275prov=y({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})();export{ye as a,ve as b};
